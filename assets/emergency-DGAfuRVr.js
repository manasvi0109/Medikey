import{F as f,r as u,u as l,j as e,T as m,C as o,a as x,b as h,d as j,B as w,a3 as b}from"./index-B_3hYsFf.js";import{S as a}from"./skeleton-DoTryf93.js";import{D as C,a as v,b as Q,c as E}from"./dialog-Dg9bbEd7.js";import{_ as p}from"./index-BSL61_qy.js";import{S as R}from"./shield-DxnqjELJ.js";import{C as S}from"./clock-Dvj09B-n.js";import{Q as k}from"./qr-code-BTDWwF22.js";import"./index-DXgMstpB.js";import"./index-Cg8ng6lj.js";function G(){const{user:t}=f(),[g,n]=u.useState(!1),{data:c,isLoading:N}=l({queryKey:["emergency-qr-code"],queryFn:b}),{data:s,isLoading:y}=l({queryKey:["user-profile"],queryFn:async()=>{const d=await fetch("/api/users/profile");if(!d.ok)throw new Error("Failed to fetch user profile");return d.json()}}),i=N||y,r=(c==null?void 0:c.url)||`${typeof window<"u"?window.location.origin:""}/emergency/${(t==null?void 0:t.id)||"user"}`;return e.jsxs("div",{className:"container mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Emergency Access"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-300",children:"Critical health information for emergency situations"})]})}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-start dark:bg-red-100",children:[e.jsx(m,{className:"h-5 w-5 text-red-500 mr-3 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Important Information"}),e.jsx("p",{className:"mt-1 text-sm text-red-700",children:"Share the QR code only with emergency healthcare providers."})]})]}),e.jsxs(o,{className:"mb-6",children:[e.jsx(x,{className:"bg-red-50",children:e.jsxs(h,{className:"text-red-800 flex items-center",children:[e.jsx(R,{className:"h-5 w-5 mr-2 text-red-600"}),"Emergency QR Code"]})}),e.jsx(j,{className:"p-6",children:i?e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx(a,{className:"h-48 w-48"}),e.jsx(a,{className:"h-4 w-64"}),e.jsx(a,{className:"h-4 w-48"})]}):e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"bg-white p-4 border border-gray-200 rounded-lg",children:r?e.jsx(p,{value:r,size:200}):e.jsx("p",{children:"Generating QR Code..."})}),e.jsx("p",{className:"text-sm mt-4 text-gray-600 text-center",children:"Scan this QR code to access medical data in emergencies."}),e.jsxs("div",{className:"flex items-center justify-center bg-red-50 p-3 rounded-md mt-2",children:[e.jsx(S,{className:"h-5 w-5 text-red-500 mr-2"}),e.jsx("p",{className:"text-xs text-red-600",children:"QR code expires in 24 hours."})]}),e.jsxs(w,{className:"mt-4",variant:"outline",onClick:()=>n(!0),children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),"View Full Screen"]})]})})]}),e.jsxs(o,{className:"mb-6",children:[e.jsx(x,{className:"bg-red-50",children:e.jsxs(h,{className:"text-red-800 flex items-center",children:[e.jsx(m,{className:"h-5 w-5 mr-2 text-red-600"}),"Critical Medical Info"]})}),e.jsx(j,{className:"p-6",children:i?e.jsxs("div",{className:"space-y-4",children:[e.jsx(a,{className:"h-8 w-full"}),e.jsx(a,{className:"h-24 w-full"})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm text-gray-500 uppercase mb-2",children:"Personal Information"}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-md space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Full Name:"})," ",(s==null?void 0:s.fullName)||"Not available"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Date of Birth:"})," ",(s==null?void 0:s.dateOfBirth)||"Not specified"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Gender:"})," ",(s==null?void 0:s.gender)||"Not specified"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Blood Type:"})," ",e.jsx("span",{className:"text-red-600 font-semibold",children:(s==null?void 0:s.bloodType)||"Not specified"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm text-gray-500 uppercase mb-2",children:"Medical Information"}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-md space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Allergies:"})," ",(s==null?void 0:s.allergies)||"None"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Chronic Conditions:"})," ",(s==null?void 0:s.chronicConditions)||"None"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Emergency Contact:"}),e.jsx("br",{}),s!=null&&s.emergencyContactName?`${s.emergencyContactName} (${s.emergencyContactPhone})`:"Not provided"]})]})]})]})})]}),e.jsx(C,{open:g,onOpenChange:n,children:e.jsxs(v,{className:"sm:max-w-md",children:[e.jsx(Q,{children:e.jsx(E,{children:"Emergency Access QR Code"})}),e.jsxs("div",{className:"flex flex-col items-center p-4",children:[r?e.jsx(p,{value:r,size:300}):e.jsx("p",{children:"Generating QR Code..."}),e.jsx("p",{className:"text-sm mt-4 text-gray-600 text-center",children:"Only share with emergency healthcare providers."})]})]})})]})}export{G as default};
