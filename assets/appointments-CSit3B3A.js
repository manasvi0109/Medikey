import{k as I,w as B,r as M,u as U,N as Q,l as $,j as e,B as g,C as j,d as f,e as N,a as K,b as R,H as n,I as h,f as p,O as r,Q as _,o as z}from"./index-C4xO3ma0.js";import{D as G,a as W,b as Z,c as J,h as X,i as ee}from"./dialog-C9SKzz07.js";import{T as P}from"./textarea-Csl--0Qg.js";import{T as te,e as se,f as V,g as k,S as ae,a as ie,b as re,c as ne,d as u}from"./tabs-Ds2f9iOA.js";import{i as le,c as L,C as q,P as oe,a as me,b as de}from"./popover-CoQr0GAU.js";import{P as Y,f as y,a as ce}from"./format-DKO96rKW.js";import{C as O}from"./clock-CJ8XQzG3.js";import{U as pe}from"./user-ySslXxYX.js";import{i as S,a as xe,M as he}from"./isTomorrow-DVvL8Cze.js";import"./index-DlSuiVLz.js";import"./index-BdQq_4o_.js";import"./index-B15eWx5m.js";import"./index-HQ0QDh0f.js";import"./chevron-right-BXGuxRN-.js";const ue=r.object({title:r.string().min(1,"Title is required"),description:r.string().optional(),appointmentType:r.string().min(1,"Appointment type is required"),providerName:r.string().min(1,"Provider name is required"),providerType:r.string().optional(),location:r.string().optional(),appointmentDate:r.date({required_error:"Appointment date is required"}),appointmentTime:r.string().min(1,"Appointment time is required"),duration:r.number().positive().optional(),reminderSet:r.boolean().default(!1),notes:r.string().optional()});function Me(){const{toast:i}=I(),m=B(),[d,c]=M.useState(!1),[l,H]=M.useState(new Date),{data:o,isLoading:C}=U({queryKey:["/api/appointments"]}),s=Q({resolver:_(ue),defaultValues:{title:"",description:"",appointmentType:"",providerName:"",providerType:"",location:"",appointmentTime:"",duration:30,reminderSet:!0,notes:""}}),v=$({mutationFn:t=>{const a=new Date(t.appointmentDate),[b,T]=t.appointmentTime.split(":").map(Number);a.setHours(b,T,0,0);const x={...t,appointmentDate:a.toISOString(),reminderTime:t.reminderSet?ce(a,-1).toISOString():null};return delete x.appointmentTime,z("POST","/api/appointments",x)},onSuccess:()=>{m.invalidateQueries({queryKey:["/api/appointments"]}),c(!1),s.reset(),i({title:"Success",description:"Appointment scheduled successfully"})},onError:t=>{i({title:"Error",description:`Failed to schedule appointment: ${t.message}`,variant:"destructive"})}}),E=t=>{v.mutate(t)},A=o?o.filter(t=>le(new Date(t.appointmentDate),new Date)).sort((t,a)=>new Date(a.appointmentDate).getTime()-new Date(t.appointmentDate).getTime()):[],D=o?o.filter(t=>L(new Date(t.appointmentDate),new Date)).sort((t,a)=>new Date(t.appointmentDate).getTime()-new Date(a.appointmentDate).getTime()):[],F=D.filter(t=>S(new Date(t.appointmentDate)));return e.jsxs("div",{className:"py-6 px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Appointments"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Manage your medical appointments and follow-ups"})]}),e.jsxs(g,{onClick:()=>c(!0),children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Schedule Appointment"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs(te,{defaultValue:"upcoming",className:"w-full",children:[e.jsxs(se,{className:"mb-4",children:[e.jsx(V,{value:"upcoming",children:"Upcoming"}),e.jsx(V,{value:"past",children:"Past Appointments"})]}),e.jsx(k,{value:"upcoming",children:C?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(t=>e.jsx(j,{className:"animate-pulse",children:e.jsx(f,{className:"p-0",children:e.jsx("div",{className:"h-20 bg-gray-100"})})},t))}):D.length>0?e.jsxs("div",{className:"space-y-4",children:[F.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Today"}),F.map(t=>e.jsx(w,{appointment:t},t.id))]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Upcoming"}),D.filter(t=>!S(new Date(t.appointmentDate))).map(t=>e.jsx(w,{appointment:t},t.id))]})]}):e.jsx(j,{className:"p-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(N,{className:"h-16 w-16 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Upcoming Appointments"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"You don't have any upcoming appointments scheduled"}),e.jsxs(g,{onClick:()=>c(!0),children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Schedule Your First Appointment"]})]})})}),e.jsx(k,{value:"past",children:C?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(t=>e.jsx(j,{className:"animate-pulse",children:e.jsx(f,{className:"p-0",children:e.jsx("div",{className:"h-20 bg-gray-100"})})},t))}):A.length>0?e.jsx("div",{className:"space-y-4",children:A.map(t=>e.jsx(w,{appointment:t,isPast:!0},t.id))}):e.jsx(j,{className:"p-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(N,{className:"h-16 w-16 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Past Appointments"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Your past appointment history will appear here"})]})})})]})}),e.jsx("div",{children:e.jsxs(j,{children:[e.jsx(K,{children:e.jsx(R,{children:"Calendar"})}),e.jsxs(f,{children:[e.jsx(q,{mode:"single",selected:l,onSelect:H,className:"rounded-md border",components:{DayContent:t=>{const a=t.date,b=o==null?void 0:o.some(T=>{const x=new Date(T.appointmentDate);return a.getDate()===x.getDate()&&a.getMonth()===x.getMonth()&&a.getFullYear()===x.getFullYear()});return e.jsxs("div",{className:"relative h-full w-full p-2",children:[e.jsx(t.day.Component,{...t}),b&&e.jsx("div",{className:"absolute bottom-1 left-1/2 transform -translate-x-1/2 w-1 h-1 bg-primary-600 rounded-full"})]})}}}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:l?y(l,"MMMM d, yyyy"):"Select a date"}),l&&o?e.jsxs("div",{children:[o.filter(t=>{const a=new Date(t.appointmentDate);return l.getDate()===a.getDate()&&l.getMonth()===a.getMonth()&&l.getFullYear()===a.getFullYear()}).map(t=>e.jsxs("div",{className:"mb-2 p-2 bg-gray-50 rounded text-sm",children:[e.jsx("div",{className:"font-medium",children:t.title}),e.jsxs("div",{className:"text-gray-500 flex items-center",children:[e.jsx(O,{className:"h-3 w-3 mr-1"}),y(new Date(t.appointmentDate),"h:mm a")]})]},t.id)),!o.some(t=>{const a=new Date(t.appointmentDate);return l.getDate()===a.getDate()&&l.getMonth()===a.getMonth()&&l.getFullYear()===a.getFullYear()})&&e.jsx("div",{className:"text-sm text-gray-500",children:"No appointments on this date"})]}):e.jsx("div",{className:"text-sm text-gray-500",children:"Loading appointments..."})]})]})]})})]}),e.jsx(G,{open:d,onOpenChange:c,children:e.jsxs(W,{className:"sm:max-w-[525px]",children:[e.jsxs(Z,{children:[e.jsx(J,{children:"Schedule New Appointment"}),e.jsx(X,{children:"Enter the details for your upcoming appointment"})]}),e.jsxs("form",{onSubmit:s.handleSubmit(E),children:[e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(n,{htmlFor:"title",children:"Appointment Title *"}),e.jsx(h,{id:"title",placeholder:"e.g. Annual Physical Exam",...s.register("title")}),s.formState.errors.title&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:s.formState.errors.title.message})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx(P,{id:"description",placeholder:"Brief description of the appointment",...s.register("description")})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"appointmentType",children:"Appointment Type *"}),e.jsxs(ae,{onValueChange:t=>s.setValue("appointmentType",t),children:[e.jsx(ie,{id:"appointmentType",children:e.jsx(re,{placeholder:"Select type"})}),e.jsxs(ne,{children:[e.jsx(u,{value:"checkup",children:"General Checkup"}),e.jsx(u,{value:"specialist",children:"Specialist Visit"}),e.jsx(u,{value:"follow_up",children:"Follow-up"}),e.jsx(u,{value:"test",children:"Lab Test"}),e.jsx(u,{value:"procedure",children:"Procedure"}),e.jsx(u,{value:"other",children:"Other"})]})]}),s.formState.errors.appointmentType&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:s.formState.errors.appointmentType.message})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"providerName",children:"Provider Name *"}),e.jsx(h,{id:"providerName",placeholder:"e.g. Dr. Smith",...s.register("providerName")}),s.formState.errors.providerName&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:s.formState.errors.providerName.message})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"providerType",children:"Provider Type"}),e.jsx(h,{id:"providerType",placeholder:"e.g. Cardiologist",...s.register("providerType")})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"location",children:"Location"}),e.jsx(h,{id:"location",placeholder:"e.g. Memorial Hospital",...s.register("location")})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Date *"}),e.jsxs(oe,{children:[e.jsx(me,{asChild:!0,children:e.jsxs(g,{variant:"outline",className:p("w-full justify-start text-left font-normal",!s.getValues("appointmentDate")&&"text-muted-foreground"),children:[e.jsx(N,{className:"mr-2 h-4 w-4"}),s.getValues("appointmentDate")?y(s.getValues("appointmentDate"),"PPP"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(de,{className:"w-auto p-0",children:e.jsx(q,{mode:"single",selected:s.getValues("appointmentDate"),onSelect:t=>s.setValue("appointmentDate",t),initialFocus:!0})})]}),s.formState.errors.appointmentDate&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:s.formState.errors.appointmentDate.message})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"appointmentTime",children:"Time *"}),e.jsx(h,{id:"appointmentTime",type:"time",...s.register("appointmentTime")}),s.formState.errors.appointmentTime&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:s.formState.errors.appointmentTime.message})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"duration",children:"Duration (minutes)"}),e.jsx(h,{id:"duration",type:"number",min:"5",step:"5",placeholder:"30",...s.register("duration",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"reminderSet",className:"rounded border-gray-300 text-primary-600 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50",...s.register("reminderSet")}),e.jsx(n,{htmlFor:"reminderSet",className:"text-sm",children:"Set reminder (1 day before)"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(n,{htmlFor:"notes",children:"Notes"}),e.jsx(P,{id:"notes",placeholder:"Any additional notes about this appointment",...s.register("notes")})]})]})}),e.jsxs(ee,{children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsx(g,{type:"submit",disabled:v.isPending,children:v.isPending?"Scheduling...":"Schedule Appointment"})]})]})]})})]})}function w({appointment:i,isPast:m=!1}){const d=new Date(i.appointmentDate);L(d,new Date);const c=S(d)?"Today":xe(d)?"Tomorrow":y(d,"MMM d, yyyy");return e.jsx(j,{className:p("mb-4",m&&"opacity-75"),children:e.jsx(f,{className:"p-0",children:e.jsxs("div",{className:"flex items-center p-4",children:[e.jsx("div",{className:p("flex-shrink-0 h-12 w-12 rounded-full flex items-center justify-center",m?"bg-gray-100":i.appointmentType==="checkup"?"bg-primary-100":i.appointmentType==="test"?"bg-green-100":"bg-blue-100"),children:i.appointmentType==="checkup"?e.jsx(pe,{className:p("h-6 w-6",m?"text-gray-500":"text-primary-600")}):i.appointmentType==="test"?e.jsxs("svg",{className:p("h-6 w-6",m?"text-gray-500":"text-green-600"),viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M19 2H5C3.89543 2 3 2.89543 3 4V20C3 21.1046 3.89543 22 5 22H19C20.1046 22 21 21.1046 21 20V4C21 2.89543 20.1046 2 19 2Z"}),e.jsx("path",{d:"M15 2V7L12 5.5L9 7V2"}),e.jsx("line",{x1:"12",y1:"11",x2:"12",y2:"17"}),e.jsx("line",{x1:"9",y1:"14",x2:"15",y2:"14"})]}):e.jsx(N,{className:p("h-6 w-6",m?"text-gray-500":"text-blue-600")})}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:i.title}),e.jsx("span",{className:p("text-xs px-2 py-1 rounded-full",m?"bg-gray-100 text-gray-800":"bg-primary-100 text-primary-800"),children:c})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[i.providerName,i.providerType?` (${i.providerType})`:""]}),e.jsxs("div",{className:"mt-2 flex items-center text-xs text-gray-500",children:[e.jsx(O,{className:"mr-1 h-3 w-3"}),e.jsx("span",{children:y(d,"h:mm a")}),i.duration&&e.jsxs("span",{className:"ml-1",children:["• ",i.duration," mins"]}),i.location&&e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"ml-3 mr-1 h-3 w-3"}),e.jsx("span",{children:i.location})]})]})]})]})})})}export{Me as default};
