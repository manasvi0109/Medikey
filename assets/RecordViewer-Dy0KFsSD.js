import{c as t,r as c,w as S,k as C,u as F,l as D,j as e,f as r,B as m,n as d,o as z}from"./index-C4xO3ma0.js";import{D as q,a as E,c as L}from"./dialog-C9SKzz07.js";import{T as A,e as $,f as x,g as o}from"./tabs-Ds2f9iOA.js";import{C as H}from"./clock-CJ8XQzG3.js";import{f as h}from"./format-DKO96rKW.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=t("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=t("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=t("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N=t("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=t("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y=t("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=t("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=t("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);function J({record:s,isOpen:w,onClose:b}){const[k,M]=c.useState("preview"),[i,p]=c.useState(!1),u=S(),{toast:j}=C(),{data:g,isLoading:T}=F({queryKey:[`/api/records/${s.id}/summary`],enabled:!s.aiSummary}),l=D({mutationFn:()=>z("POST",`/api/records/${s.id}/generate-summary`),onSuccess:()=>{u.invalidateQueries({queryKey:[`/api/records/${s.id}/summary`]}),u.invalidateQueries({queryKey:["/api/records"]}),j({title:"Summary generated",description:"AI summary has been generated for this record."})},onError:a=>{j({title:"Error",description:`Failed to generate summary: ${a.message}`,variant:"destructive"})}});c.useEffect(()=>{const a=n=>{n.key==="Escape"&&p(!1)};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[]);const f=(()=>{var n;const a=(n=s.fileName.split(".").pop())==null?void 0:n.toLowerCase();return["pdf"].includes(a||"")?"pdf":["jpg","jpeg","png","gif","webp"].includes(a||"")?"image":["doc","docx","txt","rtf"].includes(a||"")?"document":"unsupported"})();return e.jsx(q,{open:w,onOpenChange:a=>!a&&b(),className:r(i?"fixed inset-0 z-50 bg-background":""),children:e.jsxs(E,{className:r("sm:max-w-[700px] p-0 overflow-hidden",i?"w-screen h-screen max-w-none max-h-none rounded-none":""),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx(L,{className:"text-lg",children:s.title}),e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>p(!i),className:"h-8 w-8 p-0",children:i?e.jsx(G,{className:"h-4 w-4"}):e.jsx(R,{className:"h-4 w-4"})})})]}),e.jsxs(A,{defaultValue:"preview",value:k,onValueChange:M,className:"w-full",children:[e.jsx("div",{className:"border-b",children:e.jsxs("div",{className:"flex items-center justify-between px-4",children:[e.jsxs($,{className:"mt-2",children:[e.jsxs(x,{value:"preview",className:"data-[state=active]:bg-background",children:[e.jsx(N,{className:"mr-2 h-4 w-4"}),"Preview"]}),e.jsxs(x,{value:"summary",className:"data-[state=active]:bg-background",children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"AI Summary"]}),e.jsxs(x,{value:"details",className:"data-[state=active]:bg-background",children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Details"]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(m,{variant:"outline",size:"sm",children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),"Download"]})})]})}),e.jsx(o,{value:"preview",className:"m-0",children:e.jsx("div",{className:r("flex flex-col justify-center items-center bg-gray-50",i?"h-[calc(100vh-120px)]":"h-[500px]"),children:f==="image"?e.jsx("img",{src:`data:${s.fileType};base64,${s.fileContent}`,alt:s.title,className:"max-w-full max-h-full object-contain"}):f==="pdf"?e.jsx("iframe",{src:`data:${s.fileType};base64,${s.fileContent}`,className:"w-full h-full",title:s.title}):e.jsxs("div",{className:"text-center p-8",children:[e.jsx(N,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Preview not available"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"This file type cannot be previewed directly. Please download the file to view its contents."}),e.jsxs(m,{children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),"Download File"]})]})})}),e.jsx(o,{value:"summary",className:"m-0",children:e.jsx("div",{className:r("p-6 overflow-auto bg-white",i?"h-[calc(100vh-120px)]":"h-[500px]"),children:s.aiSummary?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"prose prose-sm max-w-none",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"AI-Generated Summary"}),e.jsx("div",{dangerouslySetInnerHTML:{__html:s.aiSummary}})]}),e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsx(H,{className:"mr-1 h-3 w-3"}),"Generated on ",h(new Date(s.createdAt),"MMMM d, yyyy")]}),e.jsx(m,{size:"sm",variant:"outline",onClick:()=>l.mutate(),disabled:l.isPending,children:l.isPending?e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"mr-2 h-3 w-3 animate-spin"}),"Regenerating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"mr-2 h-3 w-3"}),"Regenerate Summary"]})})]})]}):T?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[e.jsx(d,{className:"h-8 w-8 text-primary-600 animate-spin mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Analyzing document..."})]}):g?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"prose prose-sm max-w-none",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"AI-Generated Summary"}),e.jsx("div",{dangerouslySetInnerHTML:{__html:g}})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[e.jsx(y,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Summary Available"}),e.jsx("p",{className:"text-gray-500 mb-4 max-w-md",children:"Generate an AI-powered summary to quickly understand the key points in this document."}),e.jsx(m,{onClick:()=>l.mutate(),disabled:l.isPending,children:l.isPending?e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Generate Summary"]})})]})})}),e.jsx(o,{value:"details",className:"m-0",children:e.jsx("div",{className:r("p-6 overflow-auto bg-white",i?"h-[calc(100vh-120px)]":"h-[500px]"),children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Record Type"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:s.recordType.charAt(0).toUpperCase()+s.recordType.slice(1).replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Record Date"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:h(new Date(s.recordDate),"MMMM d, yyyy")})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Provider"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:s.provider})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Provider Type"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:s.providerType||"Not specified"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Description"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:s.description||"No description provided"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"File Name"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:s.fileName})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"File Size"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:I(s.fileSize)})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Tags"}),e.jsx("div",{className:"mt-1",children:s.tags&&s.tags.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:s.tags.map((a,n)=>e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800",children:a},n))}):e.jsx("p",{className:"text-sm text-gray-500",children:"No tags"})})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Upload Date"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:h(new Date(s.createdAt),"MMMM d, yyyy 'at' h:mm a")})]})]})})})]})]})})}function I(s){return s<1024?`${s} B`:s<1024*1024?`${(s/1024).toFixed(1)} KB`:`${(s/(1024*1024)).toFixed(1)} MB`}export{v as D,Z as E,N as F,J as R};
