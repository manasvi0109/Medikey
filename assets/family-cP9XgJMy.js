import{c as F,k as T,w as A,r as f,u as E,N as k,l as u,j as e,B as o,C as y,a as N,d as v,i as b,A as O,g as B,h as P,H as d,I as c,O as l,Q as q,o as j}from"./index-C4xO3ma0.js";import{D as U,a as $,b as I,c as Q,h as R,i as V}from"./dialog-C9SKzz07.js";import{T as H}from"./textarea-Csl--0Qg.js";import{D as K,a as L,E as Y,b as z,c as C}from"./dropdown-menu-CndodAqS.js";import{U as G,S as J,F as W}from"./user-plus-DDv_vi_v.js";import{U as X}from"./user-ySslXxYX.js";import"./index-DlSuiVLz.js";import"./index-B15eWx5m.js";import"./index-HQ0QDh0f.js";import"./chevron-right-BXGuxRN-.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=F("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=F("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function ee(i){const n=new Date,m=new Date(i);let r=n.getFullYear()-m.getFullYear();const t=n.getMonth()-m.getMonth();return(t<0||t===0&&n.getDate()<m.getDate())&&r--,r}const se=l.object({name:l.string().min(1,"Name is required"),relationship:l.string().min(1,"Relationship is required"),dateOfBirth:l.string().optional(),gender:l.string().optional(),bloodType:l.string().optional(),allergies:l.string().optional(),chronicConditions:l.string().optional()});function he(){const{toast:i}=T(),n=A(),[m,r]=f.useState(!1),[t,h]=f.useState(null),{data:x,isLoading:M}=E({queryKey:["/api/family-members"]}),a=k({resolver:q(se),defaultValues:{name:"",relationship:"",dateOfBirth:"",gender:"",bloodType:"",allergies:"",chronicConditions:""}}),g=u({mutationFn:s=>j("POST","/api/family-members",s),onSuccess:()=>{n.invalidateQueries({queryKey:["/api/family-members"]}),r(!1),a.reset(),i({title:"Success",description:"Family member added successfully"})},onError:s=>{i({title:"Error",description:`Failed to add family member: ${s.message}`,variant:"destructive"})}}),p=u({mutationFn:s=>j("PATCH",`/api/family-members/${s.id}`,s.member),onSuccess:()=>{n.invalidateQueries({queryKey:["/api/family-members"]}),h(null),a.reset(),i({title:"Success",description:"Family member updated successfully"})},onError:s=>{i({title:"Error",description:`Failed to update family member: ${s.message}`,variant:"destructive"})}}),w=u({mutationFn:s=>j("DELETE",`/api/family-members/${s}`),onSuccess:()=>{n.invalidateQueries({queryKey:["/api/family-members"]}),i({title:"Success",description:"Family member removed successfully"})},onError:s=>{i({title:"Error",description:`Failed to remove family member: ${s.message}`,variant:"destructive"})}}),S=s=>{t?p.mutate({id:t.id,member:s}):g.mutate(s)},D=s=>{h(s),a.reset({name:s.name,relationship:s.relationship,dateOfBirth:s.dateOfBirth||"",gender:s.gender||"",bloodType:s.bloodType||"",allergies:s.allergies||"",chronicConditions:s.chronicConditions||""})};return e.jsxs("div",{className:"py-6 px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Family Vault"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Manage your family members' health records"})]}),e.jsxs(o,{onClick:()=>{a.reset(),r(!0)},children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Add Member"]})]}),M?e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(s=>e.jsxs(y,{className:"animate-pulse",children:[e.jsx(N,{className:"h-20 bg-gray-100"}),e.jsx(v,{className:"h-40 bg-gray-50"}),e.jsx(b,{className:"h-16 bg-gray-100"})]},s))}):x&&x.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:x.map(s=>e.jsxs(y,{className:"overflow-hidden",children:[e.jsxs(N,{className:"p-4 flex items-center",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsxs(O,{className:"h-12 w-12",children:[e.jsx(B,{src:s.avatarUrl||"",alt:s.name}),e.jsx(P,{children:s.name.substring(0,2).toUpperCase()})]}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.relationship,s.dateOfBirth?`, ${ee(s.dateOfBirth)} years`:""]})]})]}),e.jsxs(K,{children:[e.jsx(L,{asChild:!0,children:e.jsx(o,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(Y,{className:"h-4 w-4"})})}),e.jsxs(z,{align:"end",children:[e.jsxs(C,{onClick:()=>D(s),children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(C,{className:"text-red-600",onClick:()=>{window.confirm(`Are you sure you want to remove ${s.name}?`)&&w.mutate(s.id)},children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),"Remove"]})]})]})]}),e.jsx(v,{className:"border-t border-gray-200 px-4 py-4",children:e.jsxs("dl",{className:"grid grid-cols-2 gap-x-4 gap-y-2",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsx("dt",{className:"text-xs font-medium text-gray-500",children:"Blood Type"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:s.bloodType||"—"})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("dt",{className:"text-xs font-medium text-gray-500",children:"Gender"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:s.gender||"—"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("dt",{className:"text-xs font-medium text-gray-500",children:"Allergies"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:s.allergies||"None"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("dt",{className:"text-xs font-medium text-gray-500",children:"Chronic Conditions"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:s.chronicConditions||"None"})]})]})}),e.jsx(b,{className:"bg-gray-50 px-4 py-3 border-t border-gray-200",children:e.jsxs(o,{variant:"outline",className:"w-full",children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),"View Medical Records"]})})]},s.id))}):e.jsx(y,{className:"p-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(X,{className:"h-16 w-16 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Family Members Yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Add family members to manage their health records all in one place"}),e.jsxs(o,{onClick:()=>r(!0),children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Add Your First Family Member"]})]})}),e.jsx(U,{open:m||!!t,onOpenChange:s=>{s||(r(!1),h(null))},children:e.jsxs($,{className:"sm:max-w-[525px]",children:[e.jsxs(I,{children:[e.jsx(Q,{children:t?"Edit Family Member":"Add Family Member"}),e.jsx(R,{children:t?"Update information for your family member":"Add a new member to your family vault"})]}),e.jsxs("form",{onSubmit:a.handleSubmit(S),children:[e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(d,{htmlFor:"name",children:"Full Name *"}),e.jsx(c,{id:"name",placeholder:"Enter full name",...a.register("name")}),a.formState.errors.name&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:a.formState.errors.name.message})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"relationship",children:"Relationship *"}),e.jsx(c,{id:"relationship",placeholder:"e.g. Spouse, Child, Parent",...a.register("relationship")}),a.formState.errors.relationship&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:a.formState.errors.relationship.message})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"dateOfBirth",children:"Date of Birth"}),e.jsx(c,{id:"dateOfBirth",type:"date",...a.register("dateOfBirth")})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"gender",children:"Gender"}),e.jsx(c,{id:"gender",placeholder:"e.g. Male, Female, Other",...a.register("gender")})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"bloodType",children:"Blood Type"}),e.jsx(c,{id:"bloodType",placeholder:"e.g. A+, B-, O+",...a.register("bloodType")})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(d,{htmlFor:"allergies",children:"Allergies"}),e.jsx(c,{id:"allergies",placeholder:"e.g. Peanuts, Penicillin",...a.register("allergies")})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(d,{htmlFor:"chronicConditions",children:"Chronic Conditions"}),e.jsx(H,{id:"chronicConditions",placeholder:"e.g. Asthma, Diabetes",...a.register("chronicConditions")})]})]})}),e.jsxs(V,{children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>{r(!1),h(null)},children:"Cancel"}),e.jsx(o,{type:"submit",disabled:g.isPending||p.isPending,children:g.isPending||p.isPending?"Saving...":"Save"})]})]})]})})]})}export{he as default};
