import{k as R,w as G,r as D,u as W,l as Z,j as e,B as N,C as y,d as T,e as b,a as _,b as z,H as l,I as j,f as u,o as J}from"./index-B_3hYsFf.js";import{D as X,a as ee,b as te,c as ae,h as se,i as ne}from"./dialog-Dg9bbEd7.js";import{T as q}from"./textarea-C4DiPniO.js";import{T as ie,e as re,f as Y,g as I,S as le,a as oe,b as me,c as ce,d as g}from"./tabs-DPpCUSf9.js";import{i as de,c as V,C as L,P as pe,a as xe,b as he}from"./popover-f3b2dAoC.js";import{P as O,f,a as ue}from"./format-DY6R5SYn.js";import{C as H}from"./clock-Dvj09B-n.js";import{U as je}from"./user-qS2fk5Zq.js";import{i as A,a as ge,M as ye}from"./isTomorrow-DGITKaiQ.js";import"./index-DXgMstpB.js";import"./index-BdQq_4o_.js";import"./index-1hd4fsLo.js";import"./index-Df15Pdw1.js";import"./chevron-right-DS5geTse.js";function Ee(){const{toast:s}=R(),c=G(),[d,p]=D.useState(!1),[o,B]=D.useState(new Date),[n,F]=D.useState({title:"",description:"",appointmentType:"checkup",providerName:"",providerType:"",location:"",appointmentTime:"09:00",duration:30,reminderSet:!0,notes:"",appointmentDate:new Date}),[i,M]=D.useState({}),{data:m,isLoading:k}=W({queryKey:["/api/appointments"]}),w=Z({mutationFn:t=>{try{const a=new Date(t.appointmentDate);if(t.appointmentTime){const[$,K]=t.appointmentTime.split(":").map(Number);a.setHours($||0,K||0,0,0)}const x={...t,appointmentDate:a.toISOString(),reminderTime:t.reminderSet?ue(a,-1).toISOString():null},{appointmentTime:h,...v}=x;return J("POST","/api/appointments",v)}catch(a){throw console.error("Error formatting appointment data:",a),new Error("Failed to format appointment data. Please check all fields.")}},onSuccess:()=>{c.invalidateQueries({queryKey:["/api/appointments"]}),p(!1),F({title:"",description:"",appointmentType:"checkup",providerName:"",providerType:"",location:"",appointmentTime:"09:00",duration:30,reminderSet:!0,notes:"",appointmentDate:new Date}),s({title:"Success",description:"Appointment scheduled successfully"})},onError:t=>{s({title:"Error",description:`Failed to schedule appointment: ${t.message}`,variant:"destructive"})}}),U=t=>{const a={};return t.title||(a.title="Title is required"),t.appointmentType||(a.appointmentType="Appointment type is required"),t.providerName||(a.providerName="Provider name is required"),t.appointmentDate||(a.appointmentDate="Appointment date is required"),t.appointmentTime||(a.appointmentTime="Appointment time is required"),M(a),Object.keys(a).length===0},r=(t,a)=>{F(x=>({...x,[t]:a})),i[t]&&M(x=>{const h={...x};return delete h[t],h})},Q=t=>{t.preventDefault();try{U(n)&&w.mutate(n)}catch(a){console.error("Error submitting appointment:",a),s({title:"Error",description:"Failed to schedule appointment. Please try again.",variant:"destructive"})}},P=m?m.filter(t=>de(new Date(t.appointmentDate),new Date)).sort((t,a)=>new Date(a.appointmentDate).getTime()-new Date(t.appointmentDate).getTime()):[],C=m?m.filter(t=>V(new Date(t.appointmentDate),new Date)).sort((t,a)=>new Date(t.appointmentDate).getTime()-new Date(a.appointmentDate).getTime()):[],E=C.filter(t=>A(new Date(t.appointmentDate)));return e.jsxs("div",{className:"container mx-auto py-6 px-4 sm:px-6 lg:px-8 bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Appointments"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Manage your medical appointments and follow-ups"})]}),e.jsxs(N,{onClick:()=>p(!0),children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),"Schedule Appointment"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs(ie,{defaultValue:"upcoming",className:"w-full",children:[e.jsxs(re,{className:"mb-4",children:[e.jsx(Y,{value:"upcoming",children:"Upcoming"}),e.jsx(Y,{value:"past",children:"Past Appointments"})]}),e.jsx(I,{value:"upcoming",children:k?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(t=>e.jsx(y,{className:"animate-pulse bg-white",children:e.jsx(T,{className:"p-0",children:e.jsx("div",{className:"h-20 bg-gray-100"})})},t))}):C.length>0?e.jsxs("div",{className:"space-y-4",children:[E.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Today"}),E.map(t=>e.jsx(S,{appointment:t},t.id))]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Upcoming"}),C.filter(t=>!A(new Date(t.appointmentDate))).map(t=>e.jsx(S,{appointment:t},t.id))]})]}):e.jsx(y,{className:"p-8 text-center bg-white",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(b,{className:"h-16 w-16 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Upcoming Appointments"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"You don't have any upcoming appointments scheduled"}),e.jsxs(N,{onClick:()=>p(!0),children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),"Schedule Your First Appointment"]})]})})}),e.jsx(I,{value:"past",children:k?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(t=>e.jsx(y,{className:"animate-pulse",children:e.jsx(T,{className:"p-0",children:e.jsx("div",{className:"h-20 bg-gray-100"})})},t))}):P.length>0?e.jsx("div",{className:"space-y-4",children:P.map(t=>e.jsx(S,{appointment:t,isPast:!0},t.id))}):e.jsx(y,{className:"p-8 text-center bg-white",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(b,{className:"h-16 w-16 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Past Appointments"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Your past appointment history will appear here"})]})})})]})}),e.jsx("div",{children:e.jsxs(y,{className:"bg-white",children:[e.jsx(_,{children:e.jsx(z,{children:"Calendar"})}),e.jsxs(T,{children:[e.jsx(L,{mode:"single",selected:o,onSelect:B,className:"rounded-md border",components:{DayContent:t=>{const a=t.date,x=Array.isArray(m)&&m.some(h=>{if(!h||!h.appointmentDate)return!1;const v=new Date(h.appointmentDate);return a.getDate()===v.getDate()&&a.getMonth()===v.getMonth()&&a.getFullYear()===v.getFullYear()});return e.jsxs("div",{className:"relative h-full w-full p-2",children:[t.day&&t.day.Component?e.jsx(t.day.Component,{...t}):e.jsx("span",{children:t.date.getDate()}),x&&e.jsx("div",{className:"absolute bottom-1 left-1/2 transform -translate-x-1/2 w-1 h-1 bg-primary-600 rounded-full"})]})}}}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:o?f(o,"MMMM d, yyyy"):"Select a date"}),o&&m?e.jsxs("div",{children:[m.filter(t=>{const a=new Date(t.appointmentDate);return o.getDate()===a.getDate()&&o.getMonth()===a.getMonth()&&o.getFullYear()===a.getFullYear()}).map(t=>e.jsxs("div",{className:"mb-2 p-2 bg-gray-50 rounded text-sm",children:[e.jsx("div",{className:"font-medium",children:t.title}),e.jsxs("div",{className:"text-gray-500 flex items-center",children:[e.jsx(H,{className:"h-3 w-3 mr-1"}),f(new Date(t.appointmentDate),"h:mm a")]})]},t.id)),!m.some(t=>{const a=new Date(t.appointmentDate);return o.getDate()===a.getDate()&&o.getMonth()===a.getMonth()&&o.getFullYear()===a.getFullYear()})&&e.jsx("div",{className:"text-sm text-gray-500",children:"No appointments on this date"})]}):e.jsx("div",{className:"text-sm text-gray-500",children:"Loading appointments..."})]})]})]})})]}),e.jsx(X,{open:d,onOpenChange:p,children:e.jsxs(ee,{className:"sm:max-w-[525px]",children:[e.jsxs(te,{children:[e.jsx(ae,{children:"Schedule New Appointment"}),e.jsx(se,{children:"Enter the details for your upcoming appointment"})]}),e.jsxs("form",{onSubmit:Q,children:[e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(l,{htmlFor:"title",children:"Appointment Title *"}),e.jsx(j,{id:"title",placeholder:"e.g. Annual Physical Exam",value:n.title,onChange:t=>r("title",t.target.value)}),i.title&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:i.title})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(l,{htmlFor:"description",children:"Description"}),e.jsx(q,{id:"description",placeholder:"Brief description of the appointment",value:n.description,onChange:t=>r("description",t.target.value)})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"appointmentType",children:"Appointment Type *"}),e.jsxs(le,{value:n.appointmentType,onValueChange:t=>r("appointmentType",t),children:[e.jsx(oe,{id:"appointmentType",children:e.jsx(me,{placeholder:"Select type"})}),e.jsxs(ce,{children:[e.jsx(g,{value:"checkup",children:"General Checkup"}),e.jsx(g,{value:"specialist",children:"Specialist Visit"}),e.jsx(g,{value:"follow_up",children:"Follow-up"}),e.jsx(g,{value:"test",children:"Lab Test"}),e.jsx(g,{value:"procedure",children:"Procedure"}),e.jsx(g,{value:"other",children:"Other"})]})]}),i.appointmentType&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:i.appointmentType})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"providerName",children:"Provider Name *"}),e.jsx(j,{id:"providerName",placeholder:"e.g. Dr. Smith",value:n.providerName,onChange:t=>r("providerName",t.target.value)}),i.providerName&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:i.providerName})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"providerType",children:"Provider Type"}),e.jsx(j,{id:"providerType",placeholder:"e.g. Cardiologist",value:n.providerType,onChange:t=>r("providerType",t.target.value)})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"location",children:"Location"}),e.jsx(j,{id:"location",placeholder:"e.g. Memorial Hospital",value:n.location,onChange:t=>r("location",t.target.value)})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Date *"}),e.jsxs(pe,{children:[e.jsx(xe,{asChild:!0,children:e.jsxs(N,{variant:"outline",className:u("w-full justify-start text-left font-normal",!n.appointmentDate&&"text-muted-foreground"),children:[e.jsx(b,{className:"mr-2 h-4 w-4"}),n.appointmentDate?f(n.appointmentDate,"PPP"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(he,{className:"w-auto p-0",children:e.jsx(L,{mode:"single",selected:n.appointmentDate,onSelect:t=>r("appointmentDate",t),initialFocus:!0})})]}),i.appointmentDate&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:i.appointmentDate})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"appointmentTime",children:"Time *"}),e.jsx(j,{id:"appointmentTime",type:"time",value:n.appointmentTime,onChange:t=>r("appointmentTime",t.target.value)}),i.appointmentTime&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:i.appointmentTime})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"duration",children:"Duration (minutes)"}),e.jsx(j,{id:"duration",type:"number",min:"5",step:"5",placeholder:"30",value:n.duration||"",onChange:t=>r("duration",parseInt(t.target.value)||void 0)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"reminderSet",className:"rounded border-gray-300 text-primary-600 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50",checked:n.reminderSet,onChange:t=>r("reminderSet",t.target.checked)}),e.jsx(l,{htmlFor:"reminderSet",className:"text-sm",children:"Set reminder (1 day before)"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(l,{htmlFor:"notes",children:"Notes"}),e.jsx(q,{id:"notes",placeholder:"Any additional notes about this appointment",value:n.notes,onChange:t=>r("notes",t.target.value)})]})]})}),e.jsxs(ne,{children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(N,{type:"submit",disabled:w.isPending,children:w.isPending?"Scheduling...":"Schedule Appointment"})]})]})]})})]})}function S({appointment:s,isPast:c=!1}){const d=new Date(s.appointmentDate);V(d,new Date);const p=A(d)?"Today":ge(d)?"Tomorrow":f(d,"MMM d, yyyy");return e.jsx(y,{className:u("mb-4 bg-white",c&&"opacity-75"),children:e.jsx(T,{className:"p-0",children:e.jsxs("div",{className:"flex items-center p-4",children:[e.jsx("div",{className:u("flex-shrink-0 h-12 w-12 rounded-full flex items-center justify-center",c?"bg-gray-100":s.appointmentType==="checkup"?"bg-primary-100":s.appointmentType==="test"?"bg-green-100":"bg-blue-100"),children:s.appointmentType==="checkup"?e.jsx(je,{className:u("h-6 w-6",c?"text-gray-500":"text-primary-600")}):s.appointmentType==="test"?e.jsxs("svg",{className:u("h-6 w-6",c?"text-gray-500":"text-green-600"),viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M19 2H5C3.89543 2 3 2.89543 3 4V20C3 21.1046 3.89543 22 5 22H19C20.1046 22 21 21.1046 21 20V4C21 2.89543 20.1046 2 19 2Z"}),e.jsx("path",{d:"M15 2V7L12 5.5L9 7V2"}),e.jsx("line",{x1:"12",y1:"11",x2:"12",y2:"17"}),e.jsx("line",{x1:"9",y1:"14",x2:"15",y2:"14"})]}):e.jsx(b,{className:u("h-6 w-6",c?"text-gray-500":"text-blue-600")})}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:s.title}),e.jsx("span",{className:u("text-xs px-2 py-1 rounded-full",c?"bg-gray-100 text-gray-800":"bg-primary-100 text-primary-800"),children:p})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.providerName,s.providerType?` (${s.providerType})`:""]}),e.jsxs("div",{className:"mt-2 flex items-center text-xs text-gray-500",children:[e.jsx(H,{className:"mr-1 h-3 w-3"}),e.jsx("span",{children:f(d,"h:mm a")}),s.duration&&e.jsxs("span",{className:"ml-1",children:["• ",s.duration," mins"]}),s.location&&e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"ml-3 mr-1 h-3 w-3"}),e.jsx("span",{children:s.location})]})]})]})]})})})}export{Ee as default};
